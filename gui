-- Roblox UI: Moveable UI with TAB toggle and display of 'running' state 

-- Create UI Elements
local CustomScreenGui = Instance.new("ScreenGui")
local MainPanel = Instance.new("Frame")
local StatusLabel = Instance.new("TextLabel")
local ToggleButtonUI = Instance.new("TextButton")
local TeleportBtn = Instance.new("TextButton")
local WatermarkText = Instance.new("TextLabel")
local TitleText = Instance.new("TextLabel")
local KillAllBtn = Instance.new("TextButton") -- KillAll Button
local CrashSheriffBtn = Instance.new("TextButton") -- Crash Sheriff Button
local CrashMurdererBtn = Instance.new("TextButton") -- Crash Murderer Button
local ShootMurdererBtn = Instance.new("TextButton") -- Shoot Murderer Button

-- Properties
CustomScreenGui.Name = "MoveableUI"
CustomScreenGui.ResetOnSpawn = false
CustomScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

MainPanel.Name = "MainPanel"
MainPanel.Parent = CustomScreenGui
MainPanel.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
MainPanel.BorderSizePixel = 0
MainPanel.Size = UDim2.new(0, 300, 0, 300) -- Square size
MainPanel.Position = UDim2.new(0.5, -150, 0.5, -150)
MainPanel.Active = true
MainPanel.Draggable = true

TitleText.Name = "TitleText"
TitleText.Parent = MainPanel
TitleText.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
TitleText.BorderSizePixel = 0
TitleText.Size = UDim2.new(1, -10, 0, 30)
TitleText.Position = UDim2.new(0, 5, 0, 5)
TitleText.Font = Enum.Font.SourceSansBold
TitleText.Text = "Coins Farmer"
TitleText.TextColor3 = Color3.new(1, 1, 1)
TitleText.TextSize = 20

StatusLabel.Name = "StatusLabel"
StatusLabel.Parent = MainPanel
StatusLabel.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
StatusLabel.BorderSizePixel = 0
StatusLabel.Size = UDim2.new(1, -10, 0, 50)
StatusLabel.Position = UDim2.new(0, 5, 0, 40)
StatusLabel.Font = Enum.Font.SourceSans
StatusLabel.Text = "Running: false"
StatusLabel.TextColor3 = Color3.new(1, 1, 1)
StatusLabel.TextSize = 24

ToggleButtonUI.Name = "ToggleButtonUI"
ToggleButtonUI.Parent = MainPanel
ToggleButtonUI.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
ToggleButtonUI.BorderSizePixel = 0
ToggleButtonUI.Size = UDim2.new(1, -10, 0, 40)
ToggleButtonUI.Position = UDim2.new(0, 5, 0, 90)
ToggleButtonUI.Font = Enum.Font.SourceSans
ToggleButtonUI.Text = "Toggle Running"
ToggleButtonUI.TextColor3 = Color3.new(1, 1, 1)
ToggleButtonUI.TextSize = 24

TeleportBtn.Name = "TeleportBtn"
TeleportBtn.Parent = MainPanel
TeleportBtn.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
TeleportBtn.BorderSizePixel = 0
TeleportBtn.Size = UDim2.new(1, -10, 0, 40)
TeleportBtn.Position = UDim2.new(0, 5, 0, 130)
TeleportBtn.Font = Enum.Font.SourceSans
TeleportBtn.Text = "Teleport to GunDrop"
TeleportBtn.TextColor3 = Color3.new(1, 1, 1)
TeleportBtn.TextSize = 24

-- New Buttons in 2 Lines
KillAllBtn.Name = "KillAllBtn"
KillAllBtn.Parent = MainPanel
KillAllBtn.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
KillAllBtn.BorderSizePixel = 0
KillAllBtn.Size = UDim2.new(0.45, -10, 0, 40) -- Reduced width for alignment
KillAllBtn.Position = UDim2.new(0, 5, 0, 170)
KillAllBtn.Font = Enum.Font.SourceSans
KillAllBtn.Text = "KillAll"
KillAllBtn.TextColor3 = Color3.new(1, 1, 1)
KillAllBtn.TextSize = 24

CrashSheriffBtn.Name = "CrashSheriffBtn"
CrashSheriffBtn.Parent = MainPanel
CrashSheriffBtn.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
CrashSheriffBtn.BorderSizePixel = 0
CrashSheriffBtn.Size = UDim2.new(0.45, -10, 0, 40) -- Reduced width for alignment
CrashSheriffBtn.Position = UDim2.new(0.55, 5, 0, 170) -- Placed next to KillAllBtn
CrashSheriffBtn.Font = Enum.Font.SourceSans
CrashSheriffBtn.Text = "Crash Sheriff"
CrashSheriffBtn.TextColor3 = Color3.new(1, 1, 1)
CrashSheriffBtn.TextSize = 24

CrashMurdererBtn.Name = "CrashMurdererBtn"
CrashMurdererBtn.Parent = MainPanel
CrashMurdererBtn.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
CrashMurdererBtn.BorderSizePixel = 0
CrashMurdererBtn.Size = UDim2.new(0.45, -10, 0, 40) -- Reduced width for alignment
CrashMurdererBtn.Position = UDim2.new(0, 5, 0, 210) -- New line
CrashMurdererBtn.Font = Enum.Font.SourceSans
CrashMurdererBtn.Text = "Crash Murderer"
CrashMurdererBtn.TextColor3 = Color3.new(1, 1, 1)
CrashMurdererBtn.TextSize = 24

ShootMurdererBtn.Name = "ShootMurdererBtn"
ShootMurdererBtn.Parent = MainPanel
ShootMurdererBtn.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
ShootMurdererBtn.BorderSizePixel = 0
ShootMurdererBtn.Size = UDim2.new(0.45, -10, 0, 40) -- Reduced width for alignment
ShootMurdererBtn.Position = UDim2.new(0.55, 5, 0, 210) -- Placed next to CrashMurdererBtn
ShootMurdererBtn.Font = Enum.Font.SourceSans
ShootMurdererBtn.Text = "Shoot Murderer"
ShootMurdererBtn.TextColor3 = Color3.new(1, 1, 1)
ShootMurdererBtn.TextSize = 24

WatermarkText.Name = "WatermarkText"
WatermarkText.Parent = MainPanel
WatermarkText.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
WatermarkText.BorderSizePixel = 0
WatermarkText.Size = UDim2.new(1, -10, 0, 30)
WatermarkText.Position = UDim2.new(0, 5, 0, 250)
WatermarkText.Font = Enum.Font.SourceSansItalic
WatermarkText.Text = "Made by ItsDanitobg"
WatermarkText.TextColor3 = Color3.new(1, 1, 1)
WatermarkText.TextSize = 18

-- UI Toggle Functionality
local uiVisibility = true
game:GetService("UserInputService").InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.Tab then
        uiVisibility = not uiVisibility
        MainPanel.Visible = uiVisibility
    end
end)

-- Variables for Coin Farming
local currentPlayer = game.Players.LocalPlayer
local playerCharacter = currentPlayer.Character or currentPlayer.CharacterAdded:Wait()
local rootPart = playerCharacter:WaitForChild("HumanoidRootPart")
local isRunning = false
local totalCoins = 0

-- Update 'Running' State
spawn(function()
    while wait(0.1) do
        StatusLabel.Text = "Running: " .. tostring(isRunning)
    end
end)

-- Toggle Button Functionality
ToggleButtonUI.MouseButton1Click:Connect(function()
    isRunning = not isRunning
    print("Running state toggled to:", isRunning)
end)

-- Teleport to GunDrop Button Functionality
TeleportBtn.MouseButton1Click:Connect(function()
    local previousPosition = rootPart.CFrame -- Save the player's current position
    local closestGunDrop = nil
    local closestDistance = math.huge

    -- Find the nearest GunDrop
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj.Name == "GunDrop" and obj:IsA("BasePart") then
            local dist = (obj.Position - rootPart.Position).Magnitude
            if dist < closestDistance then
                closestDistance = dist
                closestGunDrop = obj
            end
        end
    end

    if closestGunDrop then
        rootPart.CFrame = closestGunDrop.CFrame + Vector3.new(0, 3, 0) -- Teleport to the GunDrop
        task.wait(0.1) -- Shorter delay
        rootPart.CFrame = previousPosition -- Teleport back to the old position
    else
        print("GunDrop not found!")
    end
end)

-- Function to find all coins
local function collectAllCoins()
    local coinsList = {}
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj.Name == "Coin_Server" and obj:IsA("BasePart") then
            table.insert(coinsList, obj)
        end
    end
    return coinsList
end

-- Function to teleport to a coin
local function moveToCoin(coin)
    if not rootPart or not coin then return end
    rootPart.CFrame = coin.CFrame + Vector3.new(0, 3, 0)
end

-- Main Farming Loop
spawn(function()
    while wait(0.1) do
        if isRunning then
            local coins = collectAllCoins()
            if #coins > 0 then
                moveToCoin(coins[math.random(1, #coins)])
                totalCoins = totalCoins + 1
            end
        end
    end
end)

-- KillAll Functionality
KillAllBtn.MouseButton1Click:Connect(function()
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj.Name == "Coin_Server" and obj:IsA("BasePart") then
            obj:Destroy() -- Destroy all coins
        end
    end
end)

-- Function to handle Sheriff and Murderer actions
-- Crash, Shoot Murderer
CrashSheriffBtn.MouseButton1Click:Connect(function()
    -- Custom crash logic for Sheriff
end)
CrashMurdererBtn.MouseButton1Click:Connect(function()
    -- Custom crash logic for Murderer
end)
ShootMurdererBtn.MouseButton1Click:Connect(function()
    -- Custom shoot logic for Murderer
end)
